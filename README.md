# secKill-service

## 环境

```$xslt
系统：Windows 10 10.0_x64
内存：16G
CPU：I7-7700K
开发工具：IntelliJ IDEA 2019.1
maven：Apache Maven 3.6.0
java：jdk_1.8.0_201
springboot：2.0.7
mysql：5.7.21
mybatis：3.5.1
redis：Redis 3.2.100
rabbitmq：3.7.9
压测工具：Apache JMeter 5.1.1 
模板引擎：thymeleaf-3.0.11
```

## 接口响应测试（使用JMeter测试）

### 没有处理任何业务的情况

> 100个线程，1秒钟，循环一次请求的结果如下

|Label|样本|平均值|中位数|90% 百分位|95% 百分位|99% 百分位|最小值|最大值|异常 %|吞吐量|接收 KB/sec|发送 KB/sec|
|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|
|HTTP请求|100|1|1|2|2|2|0|3|0.000%|100.70493|7.18|13.57|
|TOTAL|100|1|1|2|2|2|0|3|0.000%|100.70493|7.18|13.57|


> 1000个线程，1秒钟，循环一次请求的结果如下

|Label|样本|平均值|中位数|90% 百分位|95% 百分位|99% 百分位|最小值|最大值|异常 %|吞吐量|接收 KB/sec|发送 KB/sec|
|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|
|HTTP请求|1000|0|1|1|1|2|0|11|0.000%|970.87379|69.21|130.84|
|TOTAL|1000|0|1|1|1|2|0|11|0.000%|970.87379|69.21|130.84|


> 10000个线程，1秒钟，循环一次请求的结果如下

|Label|样本|平均值|中位数|90% 百分位|95% 百分位|99% 百分位|最小值|最大值|异常 %|吞吐量|接收 KB/sec|发送 KB/sec|
|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|
|HTTP请求|10000|379|102|1263|1546|2009|0|2035|0.000%|2449.17952|174.60|330.07|
|TOTAL|10000|379|102|1263|1546|2009|0|2035|0.000%|2449.17952|174.60|330.07|

**结论：由于这个接口没有处理任务业务，请求完成后就返回，由此可见一个Tomcat的并发数还是很可观的！**

### 只查询 redis 数据的情况

> 100个线程，1秒钟，循环一次请求的结果如下

|Label|样本|平均值|中位数|90% 百分位|95% 百分位|99% 百分位|最小值|最大值|异常 %|吞吐量|接收 KB/sec|发送 KB/sec|
|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|
|HTTP请求|100|2|2|3|4|20|1|30|0.000%|100.80645|14.37|13.59|
|TOTAL|100|2|2|3|4|20|1|30|0.000%|100.80645|14.37|13.59|


> 1000个线程，1秒钟，循环一次请求的结果如下

|Label|样本|平均值|中位数|90% 百分位|95% 百分位|99% 百分位|最小值|最大值|异常 %|吞吐量|接收 KB/sec|发送 KB/sec|
|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|
|HTTP请求|1000|1|1|2|2|5|0|12|0.000%|968.05421|138.02|130.46|
|TOTAL|1000|1|1|2|2|5|0|12|0.000%|968.05421|138.02|130.46|

> 10000个线程，1秒钟，循环一次请求的结果如下

|Label|样本|平均值|中位数|90% 百分位|95% 百分位|99% 百分位|最小值|最大值|异常 %|吞吐量|接收 KB/sec|发送 KB/sec|
|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|
|HTTP请求|10000|884|520|2094|2262|2517|0|2857|0.000%|1999.20032|285.04|269.42|
|TOTAL|10000|884|520|2094|2262|2517|0|2857|0.000%|1999.20032|285.04|269.42|

**结论：从redis查询了一次数据后就返回和没有任务业务的对比起来差别并不是很明显，可以看出redis的查询处理速度是相当快的！**



### 只查询 mysql 数据的情况

> 100个线程，1秒钟，循环一次请求的结果如下

|Label|样本|平均值|中位数|90% 百分位|95% 百分位|99% 百分位|最小值|最大值|异常 %|吞吐量|接收 KB/sec|发送 KB/sec|
|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|
|HTTP请求|100|15|15|18|24|29|12|29|0.000%|99.20635|33.13|14.24|
|TOTAL|100|15|15|18|24|29|12|29|0.000%|99.20635|33.13|14.24|


> 1000个线程，1秒钟，循环一次请求的结果如下

|Label|样本|平均值|中位数|90% 百分位|95% 百分位|99% 百分位|最小值|最大值|异常 %|吞吐量|接收 KB/sec|发送 KB/sec|
|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|
|HTTP请求|1000|1102|972|2524|2753|2860|11|3062|0.000%|243.84297|81.44|35.00|
|TOTAL|1000|1102|972|2524|2753|2860|11|3062|0.000%|243.84297|81.44|35.00|


> 10000个线程，1秒钟，循环一次请求的结果如下

|Label|样本|平均值|中位数|90% 百分位|95% 百分位|99% 百分位|最小值|最大值|异常 %|吞吐量|接收 KB/sec|发送 KB/sec|
|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|
|HTTP请求|10000|22394|22029|41119|43453|45152|23|47803|0.000%|202.72051|67.71|29.10|
|TOTAL|10000|22394|22029|41119|43453|45152|23|47803|0.000%|202.72051|67.71|29.10|

**结论：结果很明显使用当接口的并发大到一定量的时候mysql的查询速度就会是接口响应的瓶颈，mysql可以承受的最大吞吐量是200左右。**